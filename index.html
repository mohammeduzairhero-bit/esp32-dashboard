<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #0f172a;
  color: white;
}

/* APP HEADER */
header {
  padding: 20px;
  font-size: 22px;
  font-weight: bold;
  text-align: center;
  background: #020617;
}

/* ROOM GRID */
.rooms {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  padding: 20px;
}

.room {
  background: #020617;
  padding: 25px;
  border-radius: 18px;
  text-align: center;
  font-size: 18px;
  cursor: pointer;
  transition: 0.3s;
}

.room:hover {
  background: #1e293b;
  transform: scale(1.05);
}

/* DEVICE PAGE */
.devices {
  padding: 20px;
}

/* LIGHT CARD */
.card {
  background: #020617;
  border-radius: 20px;
  padding: 20px;
  margin-bottom: 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* BULB ICON */
.bulb {
  font-size: 42px;
  color: #374151;
  transition: 0.4s;
}

.bulb.on {
  color: #ffeb3b;
  text-shadow: 0 0 20px #ffeb3b;
}

/* TOGGLE SWITCH */
.switch {
  position: relative;
  width: 55px;
  height: 28px;
}

.switch input {
  display: none;
}

.slider {
  position: absolute;
  inset: 0;
  background: #374151;
  border-radius: 20px;
  cursor: pointer;
}

.slider::before {
  content: "";
  position: absolute;
  width: 22px;
  height: 22px;
  background: white;
  border-radius: 50%;
  top: 3px;
  left: 4px;
  transition: 0.3s;
}

input:checked + .slider {
  background: #22c55e;
}

input:checked + .slider::before {
  transform: translateX(26px);
}

.back {
  background: #2563eb;
  border: none;
  color: white;
  padding: 12px;
  border-radius: 12px;
  width: 100%;
  font-size: 16px;
}
</style>
</head>

<body>

<header>üè† Smart Home</header>

<!-- ROOMS -->
<div id="roomPage" class="rooms">
  <div class="room" onclick="openRoom('Bedroom')">üõè Bedroom</div>
  <div class="room" onclick="openRoom('Bathroom')">üöø Bathroom</div>
  <div class="room" onclick="openRoom('Hall')">üõã Hall</div>
  <div class="room" onclick="openRoom('Kitchen')">üç≥ Kitchen</div>
</div>

<!-- DEVICES -->
<div id="devicePage" class="devices" style="display:none;">
  <h2 id="roomTitle"></h2>
  <div id="deviceList"></div>
  <button class="back" onclick="goBack()">‚¨Ö Back</button>
</div>

<script>
/* ===== FIREBASE ===== */
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  databaseURL: "https://esp32-home-automationz-default-rtdb.asia-southeast1.firebasedatabase.app/"
});

const db = firebase.database();

/* ROOM ‚Üí LED MAP */
const roomLEDs = {
  Bedroom: [1,2],
  Bathroom: [3],
  Hall: [4,5],
  Kitchen: [6]
};

function openRoom(room) {
  document.getElementById("roomPage").style.display = "none";
  document.getElementById("devicePage").style.display = "block";
  document.getElementById("roomTitle").innerText = room;

  const list = document.getElementById("deviceList");
  list.innerHTML = "";

  roomLEDs[room].forEach(led => {
    const id = `led${led}`;

    list.innerHTML += `
      <div class="card">
        <div>
          <div>Light ${led}</div>
          <div class="bulb" id="bulb${led}">üí°</div>
        </div>
        <label class="switch">
          <input type="checkbox" id="toggle${led}" onchange="toggleLed(${led})">
          <span class="slider"></span>
        </label>
      </div>
    `;

    /* LIVE STATUS */
    db.ref(id).on("value", snap => {
      const state = snap.val();
      document.getElementById(`toggle${led}`).checked = state === 1;
      document.getElementById(`bulb${led}`).classList.toggle("on", state === 1);
    });
  });
}

function goBack() {
  document.getElementById("devicePage").style.display = "none";
  document.getElementById("roomPage").style.display = "grid";
}

function toggleLed(led) {
  const state = document.getElementById(`toggle${led}`).checked ? 1 : 0;
  db.ref("led" + led).set(state);
}
</script>

<script>
const SpeechRecognition = 
  window.SpeechRecognition || window.webkitSpeechRecognition;

const recognition = new SpeechRecognition();
recognition.lang = "en-US";
recognition.continuous = false;

function startVoice() {
  recognition.start();
}

recognition.onresult = function(event) {
  const command = event.results[0][0].transcript.toLowerCase();
  console.log("Voice:", command);

  // BEDROOM
  if (command.includes("bedroom") && command.includes("on")) {
    setRoom([1,2], 1);
  }
  if (command.includes("bedroom") && command.includes("off")) {
    setRoom([1,2], 0);
  }

  // BATHROOM
  if (command.includes("bathroom") && command.includes("on")) {
    setRoom([3], 1);
  }
  if (command.includes("bathroom") && command.includes("off")) {
    setRoom([3], 0);
  }

  // HALL
  if (command.includes("hall") && command.includes("on")) {
    setRoom([4,5], 1);
  }
  if (command.includes("hall") && command.includes("off")) {
    setRoom([4,5], 0);
  }

  // KITCHEN
  if (command.includes("kitchen") && command.includes("on")) {
    setRoom([6], 1);
  }
  if (command.includes("kitchen") && command.includes("off")) {
    setRoom([6], 0);
  }
};

function setRoom(leds, state) {
  leds.forEach(led => {
    firebase.database().ref("led" + led).set(state);
  });
}
</script>

  
  <button onclick="startVoice()" 
style="
position:fixed;
bottom:20px;
right:20px;
background:#22c55e;
border:none;
border-radius:50%;
width:60px;
height:60px;
font-size:26px;
cursor:pointer;
">
üé§
</button>


</body>
</html>

